<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section - 7 Predictive Modeling | Cryptocurrency Research</title>
  <meta name="description" content="Section - 7 Predictive Modeling | Cryptocurrency Research" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Section - 7 Predictive Modeling | Cryptocurrency Research" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section - 7 Predictive Modeling | Cryptocurrency Research" />
  
  
  

<meta name="author" content="Riccardo (Ricky) Esclapon - LinkedIn, Personal Website" />
<meta name="author" content="John Chandler Johnson - LinkedIn" />
<meta name="author" content="Kai R. Larsen - LinkedIn, ResearchGate" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="model-validation-plan.html"/>
<link rel="next" href="evaluate-model-performance.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.15/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<script async defer src="https://hypothes.is/embed.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1RJSX0YETF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-1RJSX0YETF');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-121543940-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-121543940-3');
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html">Cryptocurrency Research</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-will-i-learn"><i class="fa fa-check"></i><b>1.1</b> What will I learn?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#before-getting-started"><i class="fa fa-check"></i><b>1.2</b> Before Getting Started</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#high-level-version"><i class="fa fa-check"></i><b>1.2.1</b> High-Level Version</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#format-notes"><i class="fa fa-check"></i><b>1.3</b> Format Notes</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#plan-of-attack"><i class="fa fa-check"></i><b>1.4</b> Plan of Attack</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#who-is-this-example-for"><i class="fa fa-check"></i><b>1.5</b> Who is this example for?</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#reproducibility"><i class="fa fa-check"></i><b>1.6</b> Reproducibility</a><ul>
<li class="chapter" data-level="1.6.1" data-path="introduction.html"><a href="introduction.html#the-cost-of-non-reproducible-research"><i class="fa fa-check"></i><b>1.6.1</b> The cost of non-reproducible research</a></li>
<li class="chapter" data-level="1.6.2" data-path="introduction.html"><a href="introduction.html#github"><i class="fa fa-check"></i><b>1.6.2</b> GitHub</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#disclaimer"><i class="fa fa-check"></i><b>1.7</b> Disclaimer</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>2</b> Setup and Installation</a><ul>
<li class="chapter" data-level="2.1" data-path="setup.html"><a href="setup.html#run-in-the-cloud"><i class="fa fa-check"></i><b>2.1</b> Option 1 - Run in the Cloud</a></li>
<li class="chapter" data-level="2.2" data-path="setup.html"><a href="setup.html#option-2---run-locally"><i class="fa fa-check"></i><b>2.2</b> Option 2 - Run Locally</a><ul>
<li class="chapter" data-level="2.2.1" data-path="setup.html"><a href="setup.html#setup-r"><i class="fa fa-check"></i><b>2.2.1</b> Setup R</a></li>
<li class="chapter" data-level="2.2.2" data-path="setup.html"><a href="setup.html#installing-and-loading-packages"><i class="fa fa-check"></i><b>2.2.2</b> Install and Load Packages</a></li>
<li class="chapter" data-level="2.2.3" data-path="setup.html"><a href="setup.html#install-pacman"><i class="fa fa-check"></i><b>2.2.3</b> Install Pacman</a></li>
<li class="chapter" data-level="2.2.4" data-path="setup.html"><a href="setup.html#load-pacman"><i class="fa fa-check"></i><b>2.2.4</b> Load Pacman</a></li>
<li class="chapter" data-level="2.2.5" data-path="setup.html"><a href="setup.html#install-all-other-packages"><i class="fa fa-check"></i><b>2.2.5</b> Install All Other Packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="explore-data.html"><a href="explore-data.html"><i class="fa fa-check"></i><b>3</b> Explore the Data</a><ul>
<li class="chapter" data-level="3.1" data-path="explore-data.html"><a href="explore-data.html#pull-the-data"><i class="fa fa-check"></i><b>3.1</b> Pull the Data</a></li>
<li class="chapter" data-level="3.2" data-path="explore-data.html"><a href="explore-data.html#data-preview"><i class="fa fa-check"></i><b>3.2</b> Data Preview</a></li>
<li class="chapter" data-level="3.3" data-path="explore-data.html"><a href="explore-data.html#the-definition-of-a-price"><i class="fa fa-check"></i><b>3.3</b> The definition of a “price”</a><ul>
<li class="chapter" data-level="3.3.1" data-path="explore-data.html"><a href="explore-data.html#order-book"><i class="fa fa-check"></i><b>3.3.1</b> Order Book</a></li>
<li class="chapter" data-level="3.3.2" data-path="explore-data.html"><a href="explore-data.html#in-summary"><i class="fa fa-check"></i><b>3.3.2</b> In Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="explore-data.html"><a href="explore-data.html#data-quality"><i class="fa fa-check"></i><b>3.4</b> Data Quality</a></li>
<li class="chapter" data-level="3.5" data-path="explore-data.html"><a href="explore-data.html#data-source-additional-details"><i class="fa fa-check"></i><b>3.5</b> Data Source Additional Details</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-prep.html"><a href="data-prep.html"><i class="fa fa-check"></i><b>4</b> Data Prep</a><ul>
<li class="chapter" data-level="4.1" data-path="data-prep.html"><a href="data-prep.html#remove-nulls"><i class="fa fa-check"></i><b>4.1</b> Remove Nulls</a></li>
<li class="chapter" data-level="4.2" data-path="data-prep.html"><a href="data-prep.html#calculate-price_usd-column"><i class="fa fa-check"></i><b>4.2</b> Calculate <code>price_usd</code> Column</a></li>
<li class="chapter" data-level="4.3" data-path="data-prep.html"><a href="data-prep.html#clean-data-by-group"><i class="fa fa-check"></i><b>4.3</b> Clean Data by Group</a><ul>
<li class="chapter" data-level="4.3.1" data-path="data-prep.html"><a href="data-prep.html#remove-symbols-without-enough-rows"><i class="fa fa-check"></i><b>4.3.1</b> Remove symbols without enough rows</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-prep.html"><a href="data-prep.html#remove-symbols-without-data-from-the-last-3-days"><i class="fa fa-check"></i><b>4.3.2</b> Remove symbols without data from the last 3 days</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-prep.html"><a href="data-prep.html#calculate-target"><i class="fa fa-check"></i><b>4.4</b> Calculate Target</a><ul>
<li class="chapter" data-level="4.4.1" data-path="data-prep.html"><a href="data-prep.html#convert-to-tsibble"><i class="fa fa-check"></i><b>4.4.1</b> Convert to tsibble</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-prep.html"><a href="data-prep.html#fill-gaps"><i class="fa fa-check"></i><b>4.4.2</b> Fill gaps</a></li>
<li class="chapter" data-level="4.4.3" data-path="data-prep.html"><a href="data-prep.html#calculate-target-1"><i class="fa fa-check"></i><b>4.4.3</b> Calculate Target</a></li>
<li class="chapter" data-level="4.4.4" data-path="data-prep.html"><a href="data-prep.html#calculate-lagged-prices"><i class="fa fa-check"></i><b>4.4.4</b> Calculate Lagged Prices</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-prep.html"><a href="data-prep.html#remove-nulls-again"><i class="fa fa-check"></i><b>4.5</b> Remove Nulls</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>5</b> Visualization 📉</a><ul>
<li class="chapter" data-level="5.1" data-path="visualization.html"><a href="visualization.html#basics---ggplot2"><i class="fa fa-check"></i><b>5.1</b> Basics - ggplot2</a></li>
<li class="chapter" data-level="5.2" data-path="visualization.html"><a href="visualization.html#using-extensions"><i class="fa fa-check"></i><b>5.2</b> Using Extensions</a><ul>
<li class="chapter" data-level="5.2.1" data-path="visualization.html"><a href="visualization.html#ggthemes"><i class="fa fa-check"></i><b>5.2.1</b> ggthemes</a></li>
<li class="chapter" data-level="5.2.2" data-path="visualization.html"><a href="visualization.html#plotly"><i class="fa fa-check"></i><b>5.2.2</b> plotly</a></li>
<li class="chapter" data-level="5.2.3" data-path="visualization.html"><a href="visualization.html#ggpubr"><i class="fa fa-check"></i><b>5.2.3</b> ggpubr</a></li>
<li class="chapter" data-level="5.2.4" data-path="visualization.html"><a href="visualization.html#ggforce"><i class="fa fa-check"></i><b>5.2.4</b> ggforce</a></li>
<li class="chapter" data-level="5.2.5" data-path="visualization.html"><a href="visualization.html#gganimate"><i class="fa fa-check"></i><b>5.2.5</b> gganimate</a></li>
<li class="chapter" data-level="5.2.6" data-path="visualization.html"><a href="visualization.html#ggtimeseries"><i class="fa fa-check"></i><b>5.2.6</b> ggTimeSeries</a></li>
<li class="chapter" data-level="5.2.7" data-path="visualization.html"><a href="visualization.html#rayshader"><i class="fa fa-check"></i><b>5.2.7</b> Rayshader</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="model-validation-plan.html"><a href="model-validation-plan.html"><i class="fa fa-check"></i><b>6</b> Model Validation Plan</a><ul>
<li class="chapter" data-level="6.1" data-path="model-validation-plan.html"><a href="model-validation-plan.html#testing-models"><i class="fa fa-check"></i><b>6.1</b> Testing Models</a></li>
<li class="chapter" data-level="6.2" data-path="model-validation-plan.html"><a href="model-validation-plan.html#cross-validation"><i class="fa fa-check"></i><b>6.2</b> Cross Validation</a><ul>
<li class="chapter" data-level="6.2.1" data-path="model-validation-plan.html"><a href="model-validation-plan.html#time-aware-cross-validation"><i class="fa fa-check"></i><b>6.2.1</b> Time Aware Cross Validation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="model-validation-plan.html"><a href="model-validation-plan.html#fix-data-by-split"><i class="fa fa-check"></i><b>6.3</b> Fix Data by Split</a><ul>
<li class="chapter" data-level="6.3.1" data-path="model-validation-plan.html"><a href="model-validation-plan.html#zero-variance"><i class="fa fa-check"></i><b>6.3.1</b> Zero Variance</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="model-validation-plan.html"><a href="model-validation-plan.html#nest-data"><i class="fa fa-check"></i><b>6.4</b> Nest data</a><ul>
<li class="chapter" data-level="6.4.1" data-path="model-validation-plan.html"><a href="model-validation-plan.html#join-results"><i class="fa fa-check"></i><b>6.4.1</b> Join Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="predictive-modeling.html"><a href="predictive-modeling.html"><i class="fa fa-check"></i><b>7</b> Predictive Modeling</a><ul>
<li class="chapter" data-level="7.1" data-path="predictive-modeling.html"><a href="predictive-modeling.html#example-simple-model"><i class="fa fa-check"></i><b>7.1</b> Example Simple Model</a><ul>
<li class="chapter" data-level="7.1.1" data-path="predictive-modeling.html"><a href="predictive-modeling.html#using-functional-programming"><i class="fa fa-check"></i><b>7.1.1</b> Using Functional Programming</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="predictive-modeling.html"><a href="predictive-modeling.html#caret"><i class="fa fa-check"></i><b>7.2</b> Caret</a><ul>
<li class="chapter" data-level="7.2.1" data-path="predictive-modeling.html"><a href="predictive-modeling.html#parallel-processing"><i class="fa fa-check"></i><b>7.2.1</b> Parallel Processing</a></li>
<li class="chapter" data-level="7.2.2" data-path="predictive-modeling.html"><a href="predictive-modeling.html#more-functional-programming"><i class="fa fa-check"></i><b>7.2.2</b> More Functional Programming</a></li>
<li class="chapter" data-level="7.2.3" data-path="predictive-modeling.html"><a href="predictive-modeling.html#generalize-the-function"><i class="fa fa-check"></i><b>7.2.3</b> Generalize the Function</a></li>
<li class="chapter" data-level="7.2.4" data-path="predictive-modeling.html"><a href="predictive-modeling.html#xgboost-models"><i class="fa fa-check"></i><b>7.2.4</b> XGBoost Models</a></li>
<li class="chapter" data-level="7.2.5" data-path="predictive-modeling.html"><a href="predictive-modeling.html#neural-network-models"><i class="fa fa-check"></i><b>7.2.5</b> Neural Network Models</a></li>
<li class="chapter" data-level="7.2.6" data-path="predictive-modeling.html"><a href="predictive-modeling.html#random-forest-models"><i class="fa fa-check"></i><b>7.2.6</b> Random Forest Models</a></li>
<li class="chapter" data-level="7.2.7" data-path="predictive-modeling.html"><a href="predictive-modeling.html#principal-component-regression"><i class="fa fa-check"></i><b>7.2.7</b> Principal Component Regression</a></li>
<li class="chapter" data-level="7.2.8" data-path="predictive-modeling.html"><a href="predictive-modeling.html#caret-options"><i class="fa fa-check"></i><b>7.2.8</b> Caret Options</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="predictive-modeling.html"><a href="predictive-modeling.html#make-predictions"><i class="fa fa-check"></i><b>7.3</b> Make Predictions</a></li>
<li class="chapter" data-level="7.4" data-path="predictive-modeling.html"><a href="predictive-modeling.html#timeseries"><i class="fa fa-check"></i><b>7.4</b> Timeseries</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html"><i class="fa fa-check"></i><b>8</b> Evaluate Model Performance</a><ul>
<li class="chapter" data-level="8.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#summarizing-models"><i class="fa fa-check"></i><b>8.1</b> Summarizing models</a><ul>
<li class="chapter" data-level="8.1.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#mae"><i class="fa fa-check"></i><b>8.1.1</b> MAE</a></li>
<li class="chapter" data-level="8.1.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#rmse"><i class="fa fa-check"></i><b>8.1.2</b> RMSE</a></li>
<li class="chapter" data-level="8.1.3" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#r-squared"><i class="fa fa-check"></i><b>8.1.3</b> R Squared</a></li>
<li class="chapter" data-level="8.1.4" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#get-metrics"><i class="fa fa-check"></i><b>8.1.4</b> Get Metrics</a></li>
<li class="chapter" data-level="8.1.5" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#comparing-metrics"><i class="fa fa-check"></i><b>8.1.5</b> Comparing Metrics</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#data-prep---adjust-prices"><i class="fa fa-check"></i><b>8.2</b> Data Prep - Adjust Prices</a><ul>
<li class="chapter" data-level="8.2.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#add-last-price"><i class="fa fa-check"></i><b>8.2.1</b> Add Last Price</a></li>
<li class="chapter" data-level="8.2.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#convert-to-percentage-change"><i class="fa fa-check"></i><b>8.2.2</b> Convert to Percentage Change</a></li>
<li class="chapter" data-level="8.2.3" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#actuals"><i class="fa fa-check"></i><b>8.2.3</b> Actuals</a></li>
<li class="chapter" data-level="8.2.4" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#actuals-as-change"><i class="fa fa-check"></i><b>8.2.4</b> Actuals as % Change</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#review-summary-statistics"><i class="fa fa-check"></i><b>8.3</b> Review Summary Statistics</a><ul>
<li class="chapter" data-level="8.3.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#calculate-r2"><i class="fa fa-check"></i><b>8.3.1</b> Calculate R^2</a></li>
<li class="chapter" data-level="8.3.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#calculate-rmse-no-NA"><i class="fa fa-check"></i><b>8.3.2</b> Calculate RMSE</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#adjust-prices-all-models"><i class="fa fa-check"></i><b>8.4</b> Adjust Prices - All Models</a><ul>
<li class="chapter" data-level="8.4.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#add-last-price-1"><i class="fa fa-check"></i><b>8.4.1</b> Add Last Price</a></li>
<li class="chapter" data-level="8.4.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#convert-to-change"><i class="fa fa-check"></i><b>8.4.2</b> Convert to % Change</a></li>
<li class="chapter" data-level="8.4.3" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#add-metrics"><i class="fa fa-check"></i><b>8.4.3</b> Add Metrics</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#evaluate-metrics-across-splits"><i class="fa fa-check"></i><b>8.5</b> Evaluate Metrics Across Splits</a><ul>
<li class="chapter" data-level="8.5.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#evaluate-rmse-test"><i class="fa fa-check"></i><b>8.5.1</b> Evaluate RMSE Test</a></li>
<li class="chapter" data-level="8.5.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#holdout-3"><i class="fa fa-check"></i><b>8.5.2</b> Holdout</a></li>
<li class="chapter" data-level="8.5.3" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#union-results"><i class="fa fa-check"></i><b>8.5.3</b> Union Results</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#evaluate-r2"><i class="fa fa-check"></i><b>8.6</b> Evaluate R^2</a><ul>
<li class="chapter" data-level="8.6.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#test-1"><i class="fa fa-check"></i><b>8.6.1</b> Test</a></li>
<li class="chapter" data-level="8.6.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#holdout-4"><i class="fa fa-check"></i><b>8.6.2</b> Holdout</a></li>
<li class="chapter" data-level="8.6.3" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#union-results-1"><i class="fa fa-check"></i><b>8.6.3</b> Union Results</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#visualize-results"><i class="fa fa-check"></i><b>8.7</b> Visualize Results</a><ul>
<li class="chapter" data-level="8.7.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#rmse-visualization"><i class="fa fa-check"></i><b>8.7.1</b> RMSE Visualization</a></li>
<li class="chapter" data-level="8.7.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#both"><i class="fa fa-check"></i><b>8.7.2</b> Both</a></li>
<li class="chapter" data-level="8.7.3" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#results-by-the-cryptocurrency"><i class="fa fa-check"></i><b>8.7.3</b> Results by the Cryptocurrency</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#interactive-dashboard"><i class="fa fa-check"></i><b>8.8</b> Interactive Dashboard</a></li>
<li class="chapter" data-level="8.9" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#visualizations---historical-metrics"><i class="fa fa-check"></i><b>8.9</b> Visualizations - Historical Metrics</a><ul>
<li class="chapter" data-level="8.9.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#best-models"><i class="fa fa-check"></i><b>8.9.1</b> Best Models</a></li>
<li class="chapter" data-level="8.9.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#most-predictable-cryptocurrency"><i class="fa fa-check"></i><b>8.9.2</b> Most Predictable Cryptocurrency</a></li>
<li class="chapter" data-level="8.9.3" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#accuracy-over-time"><i class="fa fa-check"></i><b>8.9.3</b> Accuracy Over Time</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="considerations.html"><a href="considerations.html"><i class="fa fa-check"></i><b>9</b> Considerations</a><ul>
<li class="chapter" data-level="9.1" data-path="considerations.html"><a href="considerations.html#not-a-trading-tutorial"><i class="fa fa-check"></i><b>9.1</b> Not a trading tutorial</a></li>
<li class="chapter" data-level="9.2" data-path="considerations.html"><a href="considerations.html#session-information"><i class="fa fa-check"></i><b>9.2</b> Session Information</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="archive.html"><a href="archive.html"><i class="fa fa-check"></i><b>10</b> Archive</a><ul>
<li class="chapter" data-level="10.1" data-path="archive.html"><a href="archive.html#november-2020"><i class="fa fa-check"></i><b>10.1</b> November 2020</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>11</b> References</a><ul>
<li class="chapter" data-level="11.1" data-path="references.html"><a href="references.html#document-format"><i class="fa fa-check"></i><b>11.1</b> Document Format</a></li>
<li class="chapter" data-level="11.2" data-path="references.html"><a href="references.html#open-review-toolkit-ref"><i class="fa fa-check"></i><b>11.2</b> Open Review Toolkit</a></li>
<li class="chapter" data-level="11.3" data-path="references.html"><a href="references.html#visualization-1"><i class="fa fa-check"></i><b>11.3</b> Visualization</a></li>
<li class="chapter" data-level="11.4" data-path="references.html"><a href="references.html#predictive-modeling-1"><i class="fa fa-check"></i><b>11.4</b> Predictive Modeling</a><ul>
<li class="chapter" data-level="11.4.1" data-path="references.html"><a href="references.html#time-series"><i class="fa fa-check"></i><b>11.4.1</b> Time Series</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="references.html"><a href="references.html#evaluate-model-performance-1"><i class="fa fa-check"></i><b>11.5</b> Evaluate Model Performance</a></li>
<li class="chapter" data-level="11.6" data-path="references.html"><a href="references.html#additional-contributors"><i class="fa fa-check"></i><b>11.6</b> Additional Contributors</a></li>
<li class="chapter" data-level="11.7" data-path="references.html"><a href="references.html#r-packages-used"><i class="fa fa-check"></i><b>11.7</b> R Packages Used</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="blank"><img src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" width="80"></a></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cryptocurrency Research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="predictive-modeling" class="section level1">
<h1><span class="header-section-number">Section - 7</span> Predictive Modeling</h1>
<p>We finally have everything we need to start making predictive models now that the <a href="data-prep.html#data-prep">data has been cleaned</a> and we have come up with a <a href="model-validation-plan.html#model-validation-plan">gameplan to understand the efficacy of the models</a>.</p>
<div id="example-simple-model" class="section level2">
<h2><span class="header-section-number">7.1</span> Example Simple Model</h2>
<p>We can start by making a simple <a href="https://en.wikipedia.org/wiki/Linear_regression"><strong>linear regression</strong> model</a>:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="predictive-modeling.html#cb90-1"></a><span class="kw">lm</span>(<span class="dt">formula =</span> target_price_24h <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> cryptodata)</span></code></pre></div>
<pre class="scroll-lim"><code>## 
## Call:
## lm(formula = target_price_24h ~ ., data = cryptodata)
## 
## Coefficients:
##      (Intercept)         symbolADA         symbolAMB        symbolAPPC  
##    3295.79373535        0.15763387        1.92061740       -1.09163454  
##       symbolARDR         symbolASP         symbolAVA         symbolBAT  
##       0.11510422        0.07371870        0.25457165       -0.09836750  
##        symbolBCD         symbolBCH        symbolBCHA         symbolBMC  
##       1.98345970       34.88982805        2.01992147        2.41084471  
##        symbolBNB         symbolBNT         symbolBRD         symbolBSV  
##      19.15909328        0.41378991        0.37453023        7.83243413  
##        symbolBTC         symbolBTG         symbolBTM        symbolBYTZ  
##    1454.53365776        2.51877954        1.25686713        1.63572302  
##       symbolBZRX         symbolCBC         symbolCCE         symbolCHZ  
##       1.89654722        0.04865880        1.18182162       -0.27772863  
##        symbolCKB         symbolCLO        symbolCOTI         symbolCRO  
##      -0.12178158        2.18051197        1.75737762        0.08797892  
##        symbolCRV         symbolCVC        symbolDASH         symbolDCR  
##       0.19920783        1.84416619       11.32387278        5.43999747  
##        symbolDDR        symbolDDRT         symbolDGB        symbolDGTX  
##      -0.28730093        3.27410143        0.26619429       -0.05021267  
##       symbolDOGE         symbolEDG         symbolELF         symbolENJ  
##       0.19951402        1.04134880        0.18914707        0.18177506  
##        symbolEOS         symbolETC         symbolETH         symbolETN  
##       0.33320359        3.58669234       84.76659417        1.74877643  
##        symbolETP         symbolEVX         symbolFIL         symbolFTM  
##       0.21376448        1.93022469        6.22789463        0.12134765  
##        symbolFUN        symbolGASP         symbolGLM       symbolGOLDR  
##       1.54266082        1.88783129        0.18861687        1.67286142  
##         symbolHT         symbolICX         symbolINJ         symbolINK  
##       1.24743390        1.67906407        0.53461552        2.52849225  
##       symbolIOST         symbolIPL         symbolIQN         symbolJST  
##       1.82841456       -0.00721567        2.08897191        0.10989434  
##        symbolKMD         symbolKNC         symbolLEO        symbolLEVL  
##       0.24735505        0.34810685        0.10349197        0.17051492  
##        symbolLTC        symbolMAID        symbolMANA         symbolMKR  
##       7.79903555        1.40902055       -0.12217999      135.27168515  
##        symbolNAV        symbolNEAR         symbolNEO        symbolNEXO  
##      -0.30209616        1.97210586        4.76460035        0.20696081  
##        symbolNXT         symbolOAX         symbolPOA         symbolPPC  
##       2.16110743        0.79762810        3.60461733        1.63108378  
##        symbolRCN         symbolREX         symbolRIF         symbolSBD  
##       0.37763350        1.05705861        0.06764764       -0.92043887  
##      symbolSEELE       symbolSMART         symbolSNC         symbolSNX  
##      -0.39745236       -0.08311534        1.58270146        1.91466474  
##        symbolSPC         symbolSRN       symbolSTORJ       symbolSTRAT  
##       0.16930939        2.20246166       -3.56385226        1.63044254  
##        symbolSTX         symbolSUN       symbolSUSHI        symbolSWRV  
##       1.95217549        0.86374470        0.58388468        2.34398937  
##        symbolSXP       symbolTHETA        symbolTOMO         symbolTON  
##       1.84814420        0.42380947        1.89752459       -0.05882409  
##        symbolTRX         symbolUMA         symbolUNI         symbolUNO  
##       0.10925329        2.54938380        1.12290157        3.96272559  
##        symbolVET         symbolVIB        symbolVSYS        symbolWAXP  
##       0.56022111        0.26425722        2.69418731        0.11310404  
##        symbolXEM         symbolXMR         symbolXTZ         symbolXUC  
##       0.11707983        9.81075697        1.34493636       -1.84266981  
##        symbolXVG         symbolYFI         symbolZEC         symbolZIL  
##       0.76221828     1552.09426194        6.65075840        1.78162028  
##        symbolZRX     date_time_utc              date         price_usd  
##       0.12868772       -0.00002387        1.88238791        0.83595435  
##  lagged_price_1h   lagged_price_2h   lagged_price_3h   lagged_price_6h  
##       0.01689183        0.02424647        0.05224213       -0.16131339  
## lagged_price_12h  lagged_price_24h   lagged_price_3d      trainingtest  
##      -0.00518023        0.21209600       -0.00320700       43.69365441  
##    trainingtrain             split  
##      42.25818801        9.80001772</code></pre>
<p>We defined the <span style="color: blue;"><strong>formula</strong></span> for the model as <strong><code>target_price_24h ~ .</code></strong>, which means that we are want to make predictions for the <span style="color: blue;"><strong>target_price_24h</strong></span> field, and use (<strong><code>~</code></strong>) every other column found in the data (<strong><code>.</code></strong>). In other words, we specified a model that uses the <span style="color: blue;"><strong>target_price_24h</strong></span> field as the <a href="https://en.wikipedia.org/wiki/Dependent_and_independent_variables">dependent variable</a>, and all other columns (<strong><code>.</code></strong>) as the <a href="https://en.wikipedia.org/wiki/Dependent_and_independent_variables">independent variables</a>. Meaning, we are looking to predict the <span style="color: blue;"><strong>target_price_24h</strong></span>, which is the only column that refers to the future, and use all the information available at the time the rest of the data was collected in order to infer statistical relationships that can help us forecast the future values of the <span style="color: blue;"><strong>target_price_24h</strong></span> field when it is still unknown on new data that we want to make new predictions for.</p>
<p>In the example above we used the <span style="color: blue;"><strong>cryptodata</strong></span> object which contained all the non-nested data, and was a big oversimplification of the process we will actually use.</p>
<div id="using-functional-programming" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Using Functional Programming</h3>
<!-- There are several approaches we could take in order to create the models [according to the plan outlined in the previous section](#model-validation-plan). As previously mentioned, the steps taken below use a similar approach to [the work published by Hadley Wickham on the subject](https://r4ds.had.co.nz/many-models.html) [@R_for_data_science]. Because this work is particularly well respected, we went with a methodology that uses [**functional programming**]{style="color: purple;"}. There are pros and cons to using different methods (i.e. a ***for loop***), and this tutorial itself was originally written using three different fundamentally different approaches before settling on a **functional programming** approach, which is a programming paradigm that focuses on the actions being taken, rather than focusing on  -->
<p>From this point forward, we will deal with the new dataset <span style="color: blue;"><strong>cryptodata_nested</strong></span>, review the <a href="model-validation-plan.html#nest-data">previous section where it was created</a> if you missed it. Here is a preview of the data again:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="predictive-modeling.html#cb92-1"></a>cryptodata_nested</span></code></pre></div>
<pre><code>## # A tibble: 560 x 5
## # Groups:   symbol, split [560]
##    symbol split train_data          test_data          holdout_data      
##    &lt;chr&gt;  &lt;dbl&gt; &lt;list&gt;              &lt;list&gt;             &lt;list&gt;            
##  1 BTC        1 &lt;tibble [286 x 11]&gt; &lt;tibble [90 x 11]&gt; &lt;tibble [93 x 11]&gt;
##  2 ETH        1 &lt;tibble [286 x 11]&gt; &lt;tibble [90 x 11]&gt; &lt;tibble [90 x 11]&gt;
##  3 EOS        1 &lt;tibble [286 x 11]&gt; &lt;tibble [90 x 11]&gt; &lt;tibble [93 x 11]&gt;
##  4 LTC        1 &lt;tibble [286 x 11]&gt; &lt;tibble [90 x 11]&gt; &lt;tibble [91 x 11]&gt;
##  5 ADA        1 &lt;tibble [286 x 11]&gt; &lt;tibble [90 x 11]&gt; &lt;tibble [93 x 11]&gt;
##  6 BSV        1 &lt;tibble [286 x 11]&gt; &lt;tibble [90 x 11]&gt; &lt;tibble [93 x 11]&gt;
##  7 TRX        1 &lt;tibble [286 x 11]&gt; &lt;tibble [90 x 11]&gt; &lt;tibble [93 x 11]&gt;
##  8 ZEC        1 &lt;tibble [286 x 11]&gt; &lt;tibble [90 x 11]&gt; &lt;tibble [92 x 11]&gt;
##  9 HT         1 &lt;tibble [277 x 11]&gt; &lt;tibble [89 x 11]&gt; &lt;tibble [90 x 11]&gt;
## 10 XMR        1 &lt;tibble [286 x 11]&gt; &lt;tibble [90 x 11]&gt; &lt;tibble [92 x 11]&gt;
## # ... with 550 more rows</code></pre>
<p>Because we are now dealing with a <strong>nested dataframe</strong>, performing operations on the individual nested datasets is not as straightforward. We could extract the individual elements out of the data using <a href="https://rspatial.org/intr/4-indexing.html"><span style="color: purple;"><strong>indexing</strong></span></a>, for example we can return the first element of the column <span style="color: blue;"><strong>train_data</strong></span> by running this code:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="predictive-modeling.html#cb94-1"></a>cryptodata_nested<span class="op">$</span>train_data[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## # A tibble: 286 x 11
##    date_time_utc       date       price_usd target_price_24h lagged_price_1h
##    &lt;dttm&gt;              &lt;date&gt;         &lt;dbl&gt;            &lt;dbl&gt;           &lt;dbl&gt;
##  1 2021-02-17 00:00:00 2021-02-17    49139.           52123.          49115.
##  2 2021-02-17 01:00:00 2021-02-17    49083            52278.          49139.
##  3 2021-02-17 02:00:00 2021-02-17    49290.           52129.          49083 
##  4 2021-02-17 03:00:00 2021-02-17    49654.           52311.          49290.
##  5 2021-02-17 04:00:00 2021-02-17    49662            52025.          49654.
##  6 2021-02-17 05:00:00 2021-02-17    49356.           52148.          49662 
##  7 2021-02-17 06:00:00 2021-02-17    49709.           52188.          49356.
##  8 2021-02-17 07:00:00 2021-02-17    50574.           51912.          49709.
##  9 2021-02-17 08:00:00 2021-02-17    51119.           51918.          50574.
## 10 2021-02-17 09:00:00 2021-02-17    51044.           51704.          51119.
## # ... with 276 more rows, and 6 more variables: lagged_price_2h &lt;dbl&gt;,
## #   lagged_price_3h &lt;dbl&gt;, lagged_price_6h &lt;dbl&gt;, lagged_price_12h &lt;dbl&gt;,
## #   lagged_price_24h &lt;dbl&gt;, lagged_price_3d &lt;dbl&gt;</code></pre>
<p>remove STORJ to resolve weird problem that arose March 3rd, 2021:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="predictive-modeling.html#cb96-1"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">filter</span>(cryptodata_nested, symbol <span class="op">!=</span><span class="st"> &quot;STORJ&quot;</span>)</span></code></pre></div>
<p>As we already saw dataframes are really flexible as a data structure. We can create a new column in the data to store the models themselves that are associated with each row of the data. There are several ways that we could go about doing this (this tutorial itself was written to execute the same commands using three fundamentally different methodologies), but in this tutorial we will take a <span style="color: purple;"><strong>functional programming</strong></span> approach. This means we will focus the operations we will perform on the actions we want to take themselves, which can be contrasted to a <span style="color: purple;"><strong>for loop</strong></span> which emphasizes the objects more using a similar structure that we used in the example above showing the first element of the <span style="color: blue;"><strong>train_data</strong></span> column.</p>
<p>When using a <strong>functional programming</strong> approach, we first need to create functions for the operations we want to perform. Let’s wrap the <span style="color: green;"><strong>lm()</strong></span> function <a href="predictive-modeling.html#example-simple-model">we used as an example earlier</a> and create a new custom function called <span style="color: blue;"><strong>linear_model</strong></span>, which takes a dataframe as an input (the <span style="color: blue;"><strong>train_data</strong></span> we will provide for each row of the nested dataset), and generates a linear regression model:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="predictive-modeling.html#cb97-1"></a>linear_model &lt;-<span class="st"> </span><span class="cf">function</span>(df){</span>
<span id="cb97-2"><a href="predictive-modeling.html#cb97-2"></a>  <span class="kw">lm</span>(target_price_24h <span class="op">~</span><span class="st"> </span>. <span class="op">-</span>date_time_utc <span class="op">-</span>date, <span class="dt">data =</span> df)</span>
<span id="cb97-3"><a href="predictive-modeling.html#cb97-3"></a>}</span></code></pre></div>
<p>We can now use the <span style="color: green;"><strong>map()</strong></span> function from the <a href="#https://purrr.tidyverse.org/"><span style="color: #ae7b11;"><strong>purrr</strong></span> package</a> in conjunction with the <span style="color: green;"><strong>mutate()</strong></span> function from <span style="color: #ae7b11;"><strong>dplyr</strong></span> to create a new column in the data which contains an individual linear regression model for each row of <span style="color: blue;"><strong>train_data</strong></span>:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="predictive-modeling.html#cb98-1"></a><span class="kw">mutate</span>(cryptodata_nested, <span class="dt">lm_model =</span> <span class="kw">map</span>(train_data, linear_model))</span></code></pre></div>
<pre><code>## # A tibble: 560 x 6
## # Groups:   symbol, split [560]
##    symbol split train_data          test_data         holdout_data      lm_model
##    &lt;chr&gt;  &lt;dbl&gt; &lt;list&gt;              &lt;list&gt;            &lt;list&gt;            &lt;list&gt;  
##  1 BTC        1 &lt;tibble [286 x 11]&gt; &lt;tibble [90 x 11~ &lt;tibble [93 x 11~ &lt;lm&gt;    
##  2 ETH        1 &lt;tibble [286 x 11]&gt; &lt;tibble [90 x 11~ &lt;tibble [90 x 11~ &lt;lm&gt;    
##  3 EOS        1 &lt;tibble [286 x 11]&gt; &lt;tibble [90 x 11~ &lt;tibble [93 x 11~ &lt;lm&gt;    
##  4 LTC        1 &lt;tibble [286 x 11]&gt; &lt;tibble [90 x 11~ &lt;tibble [91 x 11~ &lt;lm&gt;    
##  5 ADA        1 &lt;tibble [286 x 11]&gt; &lt;tibble [90 x 11~ &lt;tibble [93 x 11~ &lt;lm&gt;    
##  6 BSV        1 &lt;tibble [286 x 11]&gt; &lt;tibble [90 x 11~ &lt;tibble [93 x 11~ &lt;lm&gt;    
##  7 TRX        1 &lt;tibble [286 x 11]&gt; &lt;tibble [90 x 11~ &lt;tibble [93 x 11~ &lt;lm&gt;    
##  8 ZEC        1 &lt;tibble [286 x 11]&gt; &lt;tibble [90 x 11~ &lt;tibble [92 x 11~ &lt;lm&gt;    
##  9 HT         1 &lt;tibble [277 x 11]&gt; &lt;tibble [89 x 11~ &lt;tibble [90 x 11~ &lt;lm&gt;    
## 10 XMR        1 &lt;tibble [286 x 11]&gt; &lt;tibble [90 x 11~ &lt;tibble [92 x 11~ &lt;lm&gt;    
## # ... with 550 more rows</code></pre>
<p>Awesome! Now we can use the <a href="https://cryptocurrencyresearch.org/high-level/#/caret-package">same tools we learned in the high-level version to make a wider variety of predictive models to test</a></p>
</div>
</div>
<div id="caret" class="section level2">
<h2><span class="header-section-number">7.2</span> Caret</h2>
<p>Refer back to the <a href="https://cryptocurrencyresearch.org/high-level/#/caret-package">high-level version of the tutorial</a> for an explanation of the caret package, or consult this document: <a href="https://topepo.github.io/caret/index.html" class="uri">https://topepo.github.io/caret/index.html</a></p>
<div id="parallel-processing" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Parallel Processing</h3>
<p>R is a <strong><em>single thredded</em></strong> application, meaning it only uses one CPU at a time when performing operations. The step below is optional and uses the <span style="color: #ae7b11;"><strong>parallel</strong></span> and <span style="color: #ae7b11;"><strong>doParallel</strong></span> packages to allow R to use more than a single CPU when creating the predictive models, which will speed up the process considerably:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="predictive-modeling.html#cb100-1"></a>cl &lt;-<span class="st"> </span><span class="kw">makePSOCKcluster</span>(<span class="kw">detectCores</span>()<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb100-2"><a href="predictive-modeling.html#cb100-2"></a><span class="kw">registerDoParallel</span>(cl)</span></code></pre></div>
</div>
<div id="more-functional-programming" class="section level3">
<h3><span class="header-section-number">7.2.2</span> More Functional Programming</h3>
<p>Now we can repeat the process we <a href="predictive-modeling.html#using-functional-programming">used earlier to create a column with the linear regression models</a> to create <strong>the exact same models</strong>, but this time using the <span style="color: #ae7b11;"><strong>caret</strong></span> package.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="predictive-modeling.html#cb101-1"></a>linear_model_caret &lt;-<span class="st"> </span><span class="cf">function</span>(df){</span>
<span id="cb101-2"><a href="predictive-modeling.html#cb101-2"></a>  </span>
<span id="cb101-3"><a href="predictive-modeling.html#cb101-3"></a>  <span class="kw">train</span>(target_price_24h <span class="op">~</span><span class="st"> </span>. <span class="op">-</span>date_time_utc <span class="op">-</span>date, <span class="dt">data =</span> df,</span>
<span id="cb101-4"><a href="predictive-modeling.html#cb101-4"></a>        <span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>,</span>
<span id="cb101-5"><a href="predictive-modeling.html#cb101-5"></a>        <span class="dt">trControl=</span><span class="kw">trainControl</span>(<span class="dt">method=</span><span class="st">&quot;none&quot;</span>))</span>
<span id="cb101-6"><a href="predictive-modeling.html#cb101-6"></a>  </span>
<span id="cb101-7"><a href="predictive-modeling.html#cb101-7"></a>}</span></code></pre></div>
<p><em>We specified the method as <strong><code>lm</code></strong> for linear regression. See the high-level version for a refresher on how to use different <span style="color: blue;"><strong>methods</strong></span> to make different models: <a href="https://cryptocurrencyresearch.org/high-level/#/method-options" class="uri">https://cryptocurrencyresearch.org/high-level/#/method-options</a>. the <span style="color: blue;"><strong>trControl</strong></span> argument tells the <span style="color: #ae7b11;"><strong>caret</strong></span> package to avoid additional resampling of the data. As a default behavior <span style="color: #ae7b11;"><strong>caret</strong></span> will do re-sampling on the data and do <span style="color: purple;"><strong>hyperparameter tuning</strong></span> to select values to use for the paramters to get the best results, but we will avoid this discussion for this tutorial. See the <a href="https://topepo.github.io/caret/random-hyperparameter-search.html">official <span style="color: #ae7b11;"><strong>caret</strong></span> documentation for more details</a>.</em></p>
<p>Here is the full list of models that we can make using the <span style="color: #ae7b11;"><strong>caret</strong></span> package and the <a href="https://cryptocurrencyresearch.org/high-level/#/method-options">steps described the high-level version of the tutorial</a>:
<iframe src="https://topepo.github.io/caret/available-models.html" width="672" height="400px"></iframe></p>
<p>We can now use the new function we created <span style="color: blue;"><strong>linear_model_caret</strong></span> in conjunction with <span style="color: green;"><strong>map()</strong></span> and <span style="color: green;"><strong>mutate()</strong></span> to create a new column in the <span style="color: green;"><strong>cryptodata_nested</strong></span> dataset called <span style="color: blue;"><strong>lm_model</strong></span> with the trained linear regression model for each split of the data (by cryptocurrency <span style="color: blue;"><strong>symbol</strong></span> and <span style="color: blue;"><strong>split</strong></span>):</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="predictive-modeling.html#cb102-1"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_nested, </span>
<span id="cb102-2"><a href="predictive-modeling.html#cb102-2"></a>                            <span class="dt">lm_model =</span> <span class="kw">map</span>(train_data, linear_model_caret))</span></code></pre></div>
<p>We can see the new column called <span style="color: blue;"><strong>lm_model</strong></span> with the nested dataframe grouping variables:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="predictive-modeling.html#cb103-1"></a><span class="kw">select</span>(cryptodata_nested, lm_model)</span></code></pre></div>
<pre><code>## # A tibble: 560 x 3
## # Groups:   symbol, split [560]
##    symbol split lm_model
##    &lt;chr&gt;  &lt;dbl&gt; &lt;list&gt;  
##  1 BTC        1 &lt;train&gt; 
##  2 ETH        1 &lt;train&gt; 
##  3 EOS        1 &lt;train&gt; 
##  4 LTC        1 &lt;train&gt; 
##  5 ADA        1 &lt;train&gt; 
##  6 BSV        1 &lt;train&gt; 
##  7 TRX        1 &lt;train&gt; 
##  8 ZEC        1 &lt;train&gt; 
##  9 HT         1 &lt;train&gt; 
## 10 XMR        1 &lt;train&gt; 
## # ... with 550 more rows</code></pre>
<p>And we can view the summarized contents of the first trained model:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="predictive-modeling.html#cb105-1"></a>cryptodata_nested<span class="op">$</span>lm_model[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## Linear Regression 
## 
## 286 samples
##  10 predictor
## 
## No pre-processing
## Resampling: None</code></pre>
<!-- ### Cross Validation {#cross-validation-preds} -->
<!-- In the previous output, we saw the output said: ***Resampling: None*** because when building the function we specified we did not want any resampling for the [**trControl**]{style="color: blue;"} argument of the [**train()**]{style="color: green;"} function. Within each split of the data however, we can create three separate additional cross validation splits, which will allow the [**caret**]{style="color: #ae7b11;"} package to do some minimal [**hyperparameter**]{style="color: blue;"} tuning, which is the process by which it will test different options for the parameters (which vary based on the specific model being used) to find the most optimal combination of them. -->
<!-- Within each split we created, we can set caret to perform an additional cross-validation step to allow it to do a minimal level of automated hyperparameter tuning as it creates the models (the more we do the longer it will take). -->
<!-- ```{r} -->
<!-- fitControl <- trainControl(method = "repeatedcv", -->
<!--                            number = 3, -->
<!--                            repeats = 3) -->
<!-- ``` -->
</div>
<div id="generalize-the-function" class="section level3">
<h3><span class="header-section-number">7.2.3</span> Generalize the Function</h3>
<p>We can adapt the <a href="predictive-modeling.html#more-functional-programming">function we built earlier for the linear regression models using caret</a>, and add a parameter that allows us to specify the <span style="color: blue;"><strong>method</strong></span> we want to use (as in what predictive model):</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="predictive-modeling.html#cb107-1"></a>model_caret &lt;-<span class="st"> </span><span class="cf">function</span>(df, method_choice){</span>
<span id="cb107-2"><a href="predictive-modeling.html#cb107-2"></a>  </span>
<span id="cb107-3"><a href="predictive-modeling.html#cb107-3"></a>  <span class="kw">train</span>(target_price_24h <span class="op">~</span><span class="st"> </span>. <span class="op">-</span>date_time_utc <span class="op">-</span>date, <span class="dt">data =</span> df,</span>
<span id="cb107-4"><a href="predictive-modeling.html#cb107-4"></a>        <span class="dt">method =</span> method_choice,</span>
<span id="cb107-5"><a href="predictive-modeling.html#cb107-5"></a>        <span class="dt">trControl=</span><span class="kw">trainControl</span>(<span class="dt">method=</span><span class="st">&quot;none&quot;</span>))</span>
<span id="cb107-6"><a href="predictive-modeling.html#cb107-6"></a></span>
<span id="cb107-7"><a href="predictive-modeling.html#cb107-7"></a>}</span></code></pre></div>
</div>
<div id="xgboost-models" class="section level3">
<h3><span class="header-section-number">7.2.4</span> XGBoost Models</h3>
<p>Now we can do the same thing we did <a href="predictive-modeling.html#more-functional-programming">earlier for the linear regression models</a>, but use the new function called <span style="color: blue;"><strong>model_caret</strong></span> using the <span style="color: green;"><strong>map2()</strong></span> function to also specify the model as <span style="color: blue;"><strong>xgbLinear</strong></span> to create an <span style="color: purple;"><strong>XGBoost</strong></span> model:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="predictive-modeling.html#cb108-1"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_nested, </span>
<span id="cb108-2"><a href="predictive-modeling.html#cb108-2"></a>                            <span class="dt">xgb_model =</span> <span class="kw">map2</span>(train_data, <span class="st">&quot;xgbLinear&quot;</span>, model_caret))</span></code></pre></div>
<p>We won’t dive into the specifics of each individual model as the correct one to use may depend on a lot of factors and that is a discussion outside the scope of this tutorial. We chose to use the <a href="https://xgboost.readthedocs.io/en/latest/parameter.html"><strong>XGBoost</strong></a> model as an example because it has recently <a href="https://towardsdatascience.com/https-medium-com-vishalmorde-xgboost-algorithm-long-she-may-rein-edd9f99be63d">gained a lot of popularity as a very effective framework for a variety of problems</a>, and is an essential model for any data scientist to have at their disposal.</p>
<p>There are several possible configurations for XGBoost models, you can find the official documentation here: <a href="https://xgboost.readthedocs.io/en/latest/parameter.html" class="uri">https://xgboost.readthedocs.io/en/latest/parameter.html</a></p>
</div>
<div id="neural-network-models" class="section level3">
<h3><span class="header-section-number">7.2.5</span> Neural Network Models</h3>
<p>We can keep adding models. As we saw, <a href="https://topepo.github.io/caret/available-models.html">caret allows for the usage of over 200 predictive models</a>. Let’s make another set of models, this time setting the <span style="color: blue;"><strong>method</strong></span> to <span style="color: blue;"><strong><em><code>dnn</code></em></strong></span> to create <span style="color: purple;"><strong>deep neural networks</strong></span> :</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="predictive-modeling.html#cb109-1"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_nested, </span>
<span id="cb109-2"><a href="predictive-modeling.html#cb109-2"></a>                            <span class="dt">nnet_model =</span> <span class="kw">map2</span>(train_data, <span class="st">&quot;dnn&quot;</span>, model_caret))</span></code></pre></div>
<p><em>Again, we will not dive into the specifics of the individual models, but a quick Google search will return a myriad of information on the subject.</em></p>
<!-- ### Bayesian Regularized Neural Network Models -->
<!-- Next let's create [Bayesian Regularized Neural Network](https://stats.stackexchange.com/questions/328342/is-bayesian-ridge-regression-another-name-of-bayesian-linear-regression) models using the [**method**]{style="color: blue;"} [***`brnn`***]{style="color: blue;"} -->
<!-- ```{r bayesian_ridge_regression} -->
<!-- cryptodata_nested <- mutate(cryptodata_nested,  -->
<!--                             brnn_model = map2(train_data, "brnn", model_caret)) -->
<!-- ``` -->
<!-- ### Elastic Net Models - removed because of package conflict-->
<!-- Next let's create [Elastic Net](https://en.wikipedia.org/wiki/Elastic_net_regularization) models using the [**method**]{style="color: blue;"} [***`brnn`***]{style="color: blue;"} -->
<!-- ```{r elastic_net_models} -->
<!-- cryptodata_nested <- mutate(cryptodata_nested,  -->
<!--                             enet_model = map2(train_data, "enet", model_caret)) -->
<!-- ``` -->
</div>
<div id="random-forest-models" class="section level3">
<h3><span class="header-section-number">7.2.6</span> Random Forest Models</h3>
<p>Next let’s use create <a href="https://stats.stackexchange.com/questions/12140/conditional-inference-trees-vs-traditional-decision-trees">Random Forest</a> models using the <a href="https://en.wikipedia.org/wiki/Random_forest"><span style="color: blue;"><strong>method</strong></span> <span style="color: blue;"><strong><em><code>ctree</code></em></strong></span></a></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="predictive-modeling.html#cb110-1"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_nested, </span>
<span id="cb110-2"><a href="predictive-modeling.html#cb110-2"></a>                            <span class="dt">rf_model =</span> <span class="kw">map2</span>(train_data, <span class="st">&quot;ctree&quot;</span>, model_caret))</span></code></pre></div>
</div>
<div id="principal-component-regression" class="section level3">
<h3><span class="header-section-number">7.2.7</span> Principal Component Regression</h3>
<p>For one last set of models, let’s make <a href="https://en.wikipedia.org/wiki/Principal_Component_Regression">Principal Component Regression</a> models using the <span style="color: blue;"><strong>method</strong></span> <span style="color: blue;"><strong><em><code>pcr</code></em></strong></span></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="predictive-modeling.html#cb111-1"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_nested, </span>
<span id="cb111-2"><a href="predictive-modeling.html#cb111-2"></a>                            <span class="dt">pcr_model =</span> <span class="kw">map2</span>(train_data, <span class="st">&quot;pcr&quot;</span>, model_caret))</span></code></pre></div>
</div>
<div id="caret-options" class="section level3">
<h3><span class="header-section-number">7.2.8</span> Caret Options</h3>
<p>Caret offers some additional options to help pre-process the data as well. We outlined an <a href="https://cryptocurrencyresearch.org/high-level/#/caret-additional-options">example of this in the high-level version of the tutorial when showing how to make a <span style="color: purple;"><strong>Support Vector Machine</strong></span> model</a>, which requires the data to be <span style="color: purple;"><strong>centered</strong></span> and <span style="color: purple;"><strong>scaled</strong></span> to avoid running into problems (which we won’t discuss further here).</p>
</div>
</div>
<div id="make-predictions" class="section level2">
<h2><span class="header-section-number">7.3</span> Make Predictions</h2>
<p>Awesome! We have trained the predictive models, and we want to start getting a better understanding of how accurate the models are on data they have never seen before. In order to make these comparisons, we will want to make predictions on the test and holdout datasets, and compare those predictions to what actually ended up happening.</p>
<p>In order to make predictions, we can use the <span style="color: green;"><strong>prediict()</strong></span> function, here is an example on the first elements of the nested dataframe:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="predictive-modeling.html#cb112-1"></a><span class="kw">predict</span>(<span class="dt">object =</span> cryptodata_nested<span class="op">$</span>lm_model[[<span class="dv">1</span>]],</span>
<span id="cb112-2"><a href="predictive-modeling.html#cb112-2"></a>        <span class="dt">newdata =</span> cryptodata_nested<span class="op">$</span>test_data[[<span class="dv">1</span>]],</span>
<span id="cb112-3"><a href="predictive-modeling.html#cb112-3"></a>        <span class="dt">na.action =</span> na.pass)</span></code></pre></div>
<pre><code>##        1        2        3        4        5        6        7        8 
## 49383.59 49597.05 49876.80 49879.73 50069.87 49955.20 50448.06 50309.66 
##        9       10       11       12       13       14       15       16 
## 50278.53 50337.61 50223.42 50418.97 50643.49 50932.87 51091.48 50712.80 
##       17       18       19       20       21       22       23       24 
## 50712.00 50735.15 50401.67 50408.89 50071.08 50092.06 49993.87 50394.50 
##       25       26       27       28       29       30       31       32 
## 50543.25 50272.28 50243.48 50198.71 50303.91 50330.22 50358.33 49557.00 
##       33       34       35       36       37       38       39       40 
## 49622.75 49373.03 49116.10 49197.75 49160.62 49744.02 50056.63 50132.62 
##       41       42       43       44       45       46       47       48 
## 50421.66 50614.21 50944.46 51331.93 51169.19 51621.72 51814.12 52484.33 
##       49       50       51       52       53       54       55       56 
## 52903.65 52974.84 53197.51 53906.88 53489.32 52884.96 53050.08 53041.25 
##       57       58       59       60       61       62       63       64 
## 53251.90 53002.45 52655.69 52265.61 52337.60 52054.03 51876.33 51834.80 
##       65       66       67       68       69       70       71       72 
## 52298.51 51977.12 51271.75 50782.67 51015.55 50811.35 50901.41 51115.26 
##       73       74       75       76       77       78       79       80 
## 50405.78 50477.24 50415.06 50307.20 50470.67 50313.51 50208.82 50431.37 
##       81       82       83       84       85       86       87       88 
## 49777.12 49204.91 49287.78 49183.78 49031.56 49133.70 49145.24 48321.54 
##       89       90 
## 48136.75 48242.34</code></pre>
<p>Now we can create a new custom function called <span style="color: blue;"><strong>make_predictions</strong></span> that wraps this functionality in a way that we can use with <span style="color: green;"><strong>map()</strong></span> to iterate through all options of the nested dataframe:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="predictive-modeling.html#cb114-1"></a>make_predictions &lt;-<span class="st"> </span><span class="cf">function</span>(model, test){</span>
<span id="cb114-2"><a href="predictive-modeling.html#cb114-2"></a>  </span>
<span id="cb114-3"><a href="predictive-modeling.html#cb114-3"></a>  <span class="kw">predict</span>(<span class="dt">object  =</span> model, <span class="dt">newdata =</span> test, <span class="dt">na.action =</span> na.pass)</span>
<span id="cb114-4"><a href="predictive-modeling.html#cb114-4"></a>  </span>
<span id="cb114-5"><a href="predictive-modeling.html#cb114-5"></a>}</span></code></pre></div>
<p>Now we can create the new columns <span style="color: blue;"><strong>lm_test_predictions</strong></span> and <span style="color: blue;"><strong>lm_holdout_predictions</strong></span> with the predictions:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="predictive-modeling.html#cb115-1"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_nested, </span>
<span id="cb115-2"><a href="predictive-modeling.html#cb115-2"></a>                            <span class="dt">lm_test_predictions =</span>  <span class="kw">map2</span>(lm_model,</span>
<span id="cb115-3"><a href="predictive-modeling.html#cb115-3"></a>                                                   test_data,</span>
<span id="cb115-4"><a href="predictive-modeling.html#cb115-4"></a>                                                   make_predictions),</span>
<span id="cb115-5"><a href="predictive-modeling.html#cb115-5"></a>                            </span>
<span id="cb115-6"><a href="predictive-modeling.html#cb115-6"></a>                            <span class="dt">lm_holdout_predictions =</span>  <span class="kw">map2</span>(lm_model,</span>
<span id="cb115-7"><a href="predictive-modeling.html#cb115-7"></a>                                                      holdout_data,</span>
<span id="cb115-8"><a href="predictive-modeling.html#cb115-8"></a>                                                      make_predictions))</span></code></pre></div>
<p>The predictions were made using the models that had only seen the <strong>training data</strong>, and we can start assessing how good the model is on data it has not seen before in the <strong>test</strong> and <strong>holdout</strong> sets. Let’s view the results from the previous step:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="predictive-modeling.html#cb116-1"></a><span class="kw">select</span>(cryptodata_nested, lm_test_predictions, lm_holdout_predictions)</span></code></pre></div>
<pre><code>## # A tibble: 560 x 4
## # Groups:   symbol, split [560]
##    symbol split lm_test_predictions lm_holdout_predictions
##    &lt;chr&gt;  &lt;dbl&gt; &lt;list&gt;              &lt;list&gt;                
##  1 BTC        1 &lt;dbl [90]&gt;          &lt;dbl [93]&gt;            
##  2 ETH        1 &lt;dbl [90]&gt;          &lt;dbl [90]&gt;            
##  3 EOS        1 &lt;dbl [90]&gt;          &lt;dbl [93]&gt;            
##  4 LTC        1 &lt;dbl [90]&gt;          &lt;dbl [91]&gt;            
##  5 ADA        1 &lt;dbl [90]&gt;          &lt;dbl [93]&gt;            
##  6 BSV        1 &lt;dbl [90]&gt;          &lt;dbl [93]&gt;            
##  7 TRX        1 &lt;dbl [90]&gt;          &lt;dbl [93]&gt;            
##  8 ZEC        1 &lt;dbl [90]&gt;          &lt;dbl [92]&gt;            
##  9 HT         1 &lt;dbl [89]&gt;          &lt;dbl [90]&gt;            
## 10 XMR        1 &lt;dbl [90]&gt;          &lt;dbl [92]&gt;            
## # ... with 550 more rows</code></pre>
<p>Now we can do the same for the rest of the models:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="predictive-modeling.html#cb118-1"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_nested, </span>
<span id="cb118-2"><a href="predictive-modeling.html#cb118-2"></a>                            <span class="co"># XGBoost:</span></span>
<span id="cb118-3"><a href="predictive-modeling.html#cb118-3"></a>                            <span class="dt">xgb_test_predictions =</span>  <span class="kw">map2</span>(xgb_model,</span>
<span id="cb118-4"><a href="predictive-modeling.html#cb118-4"></a>                                                         test_data,</span>
<span id="cb118-5"><a href="predictive-modeling.html#cb118-5"></a>                                                         make_predictions),</span>
<span id="cb118-6"><a href="predictive-modeling.html#cb118-6"></a>                            <span class="co"># holdout</span></span>
<span id="cb118-7"><a href="predictive-modeling.html#cb118-7"></a>                            <span class="dt">xgb_holdout_predictions =</span>  <span class="kw">map2</span>(xgb_model,</span>
<span id="cb118-8"><a href="predictive-modeling.html#cb118-8"></a>                                                            holdout_data,</span>
<span id="cb118-9"><a href="predictive-modeling.html#cb118-9"></a>                                                            make_predictions),</span>
<span id="cb118-10"><a href="predictive-modeling.html#cb118-10"></a>                            <span class="co"># Neural Network:</span></span>
<span id="cb118-11"><a href="predictive-modeling.html#cb118-11"></a>                            <span class="dt">nnet_test_predictions =</span>  <span class="kw">map2</span>(nnet_model,</span>
<span id="cb118-12"><a href="predictive-modeling.html#cb118-12"></a>                                                          test_data,</span>
<span id="cb118-13"><a href="predictive-modeling.html#cb118-13"></a>                                                          make_predictions),</span>
<span id="cb118-14"><a href="predictive-modeling.html#cb118-14"></a>                            <span class="co"># holdout</span></span>
<span id="cb118-15"><a href="predictive-modeling.html#cb118-15"></a>                            <span class="dt">nnet_holdout_predictions =</span>  <span class="kw">map2</span>(nnet_model,</span>
<span id="cb118-16"><a href="predictive-modeling.html#cb118-16"></a>                                                             holdout_data,</span>
<span id="cb118-17"><a href="predictive-modeling.html#cb118-17"></a>                                                             make_predictions),</span>
<span id="cb118-18"><a href="predictive-modeling.html#cb118-18"></a>                            <span class="co"># Random Forest:</span></span>
<span id="cb118-19"><a href="predictive-modeling.html#cb118-19"></a>                            <span class="dt">rf_test_predictions =</span>  <span class="kw">map2</span>(rf_model,</span>
<span id="cb118-20"><a href="predictive-modeling.html#cb118-20"></a>                                                               test_data,</span>
<span id="cb118-21"><a href="predictive-modeling.html#cb118-21"></a>                                                               make_predictions),</span>
<span id="cb118-22"><a href="predictive-modeling.html#cb118-22"></a>                            <span class="co"># holdout</span></span>
<span id="cb118-23"><a href="predictive-modeling.html#cb118-23"></a>                            <span class="dt">rf_holdout_predictions =</span>  <span class="kw">map2</span>(rf_model,</span>
<span id="cb118-24"><a href="predictive-modeling.html#cb118-24"></a>                                                                  holdout_data,</span>
<span id="cb118-25"><a href="predictive-modeling.html#cb118-25"></a>                                                                  make_predictions),</span>
<span id="cb118-26"><a href="predictive-modeling.html#cb118-26"></a>                            <span class="co"># PCR:</span></span>
<span id="cb118-27"><a href="predictive-modeling.html#cb118-27"></a>                            <span class="dt">pcr_test_predictions =</span>  <span class="kw">map2</span>(pcr_model,</span>
<span id="cb118-28"><a href="predictive-modeling.html#cb118-28"></a>                                                         test_data,</span>
<span id="cb118-29"><a href="predictive-modeling.html#cb118-29"></a>                                                         make_predictions),</span>
<span id="cb118-30"><a href="predictive-modeling.html#cb118-30"></a>                            <span class="co"># holdout</span></span>
<span id="cb118-31"><a href="predictive-modeling.html#cb118-31"></a>                            <span class="dt">pcr_holdout_predictions =</span>  <span class="kw">map2</span>(pcr_model,</span>
<span id="cb118-32"><a href="predictive-modeling.html#cb118-32"></a>                                                            holdout_data,</span>
<span id="cb118-33"><a href="predictive-modeling.html#cb118-33"></a>                                                            make_predictions))</span></code></pre></div>
<p>We are done using the <span style="color: #ae7b11;"><strong>caret</strong></span> package and can stop the parallel processing cluster:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="predictive-modeling.html#cb119-1"></a><span class="kw">stopCluster</span>(cl)</span></code></pre></div>

<div class="infoicon">
In this example we used the <a href="https://topepo.github.io/caret/">caret package</a> because it provides a straightforward option to create a variety of models, but there are several great similar alternatives to make a variety of models in both R and Python. Some noteworthy mentions are <a href="https://www.tidymodels.org/">tidymodels</a>, <a href="https://mlr3.mlr-org.com/">mlr</a>, and <a href="https://scikit-learn.org/stable/">scikit-learn</a>.
</div>

</div>
<div id="timeseries" class="section level2">
<h2><span class="header-section-number">7.4</span> Timeseries</h2>
<p>Because this tutorial is already very dense, we will just focus on the models we created above. When creating predictive models on timeseries data there are some other excellent options which consider when the information was collected in similar but more intricate ways to the way we did when creating the lagged variables.</p>
<p>For more information on using excellent tools for <a href="https://cryptocurrencyresearch.org/high-level/#/timeseries-predictive-modeling">ARIMA and ETS models, consult the high-level version of this tutorial where they were discussed</a>.</p>
<!-- [TODO - HERE TALK ABOUT ARIMA AND ETS AND MAKE MODELS! KEEP SAME STRUCTURE AND WILL BE ABLE TO DO postResample()] -->
<!-- [TODO - AFTERWARDS ALSO NEED TO ADD NEW STEPS INTO NEXT SECTION!] -->
<!-- ### Convert to tsibble {#convert-to-tsibble-pred-model} -->
<!-- Repeat the steps we performed in the [Data Prep section to convert the data to the [**tsibble**]{style="color: blue;"} format](#convert-to-tsibble): -->
<!-- STEPS BELOW NEED TO BE CONVERTED FOR NESTED DATA USING FUNCTIONAL PROGRAMMING -->
<!-- ```{r} -->
<!-- cryptodata <- mutate(cryptodata, ts_index = anytime(paste0(pkDummy,':00:00'))) -->
<!-- # Distinct data by ts_index and symbol -->
<!-- cryptodata <- distinct(cryptodata, symbol, ts_index, .keep_all=TRUE) -->
<!-- # Convert to tsibble -->
<!-- cryptodata <- as_tsibble(cryptodata, index = ts_index, key = symbol) -->
<!-- ``` -->
<p>Move on to the <a href="evaluate-model-performance.html#evaluate-model-performance">next section</a> ➡️ to assess the accuracy of the models as described in the <a href="model-validation-plan.html#model-validation-plan">previous section</a>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="model-validation-plan.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="evaluate-model-performance.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ries9112/cryptocurrencyresearch-org/blob/master/06-PredictiveModeling.Rmd",
"text": "View Code on GitHub"
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
